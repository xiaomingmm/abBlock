/*!
 *
 * abBlock-v1.5 (导航定位&吸顶)滚动插件
 * 官网: http://ab.geshai.com/other-plus/abBlock
 *  
 * 有疑难问题可选择QQ群① 158544200 或QQ群② 790370978 进行反馈
 * 
 * Copyright 2010-2022, Carlo,Cloud
 *
 * 请尊重原创，保留头部版权
 * 在保留版权的前提下，可应用于个人或商业用途
 *
 */
;!function(a){a.fn.abBlock=function(b){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;a.fn.abBlock.__defs={_version:1.5,scroll:"html,body",tit:!1,titContainer:"",block:!1,stickType:"left",positionType:1,offsetY:0,offsetX:0,early:0,appoint:!1,place:!1,onClass:!1,offClass:!1,titOnClass:"on",speed:250,rollType:0,callback:null,_rd:"ab$1",_style:"#ab_$1_x",_topExp:"ab_$1_fixed",_onClass:"ab_$1_def"},b=a.extend({},a.fn.abBlock.__defs,b),b.callbackFunc=function(b,c){a.isFunction(this.callback)&&this.callback(b,c)},b.isIE6=function(){return a.browser.msie&&parseInt(a.browser.version)<7},b.scrollTop=function(){return parseFloat(a(window).scrollTop())},b.randStr=function(){var d,a=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],b=0,c=[];for(d=0;10>d;d++)b=Math.max(Math.ceil(26*Math.random()),1),c.push(a[b-1]);return c.join("")},b.titIsOff=function(){return!1===this.tit},b.px=function(a){return a.toString()+"px"},b.winDocWh=function(){return{winW:a(window).width(),winH:a(window).height()}},b.getRollType=function(){return/^[12]$/.test(this.rollType)?parseInt(this.rollType):0},b.hasLen=function(a){return 0!=a.length},b.valueTop=function(b){if(!1===b)return 0;if(/^[1-9]([0-9]+)?$/.test(b))return parseFloat(b);var c=a(b);return this.hasLen(c)?c.offset().top:0},b.elInfo=function(a){return{oTop:a.offset().top,oHeight:a.outerHeight()}},b.blockSet=function(a){var b=g.eq(a);return{index:a,top:b.offset().top-o,left:b.offset().left,oWidth:b.outerWidth(!0),oHeight:b.outerHeight(!0)}},b.animate=function(c){var d=this.blockSet(c);a(this.scroll).stop(!0,!0).animate({scrollTop:this.px(d.top)},this.speed,function(){b.setIsClick(!1)})},b.tcView=function(a){a?f.hasClass(this._onClass)||f.removeClass(i).addClass(h).addClass(this._onClass):f.hasClass(this._onClass)&&f.addClass(i).removeClass(h).removeClass(this._onClass)},b.setClass=function(){!this.titIsOff()&&this.hasLen(e)&&(-1==q?e.removeClass(j):e.eq(q).removeClass(j),e.eq(p).addClass(j))},b.scrollExp=function(){var b=this.scrollTop(),c=b+1+o;1>=g.length||g.eq(1).offset().top>c?p=0:g.each(function(b,d){var e=b+1;if(e<g.length){if(a(d).offset().top<=c&&g.eq(e).offset().top>c)return p=b,!0}else if(a(d).offset().top<=c||c+a(window).height()+1>=a(document).height())return p=b,!0}),p!=q&&this.setClass(),b>=w?this.scrollView(!0):this.scrollView(!1),q=p,v=c,this.callbackFunc(p,v)},b.scrollView=function(a){switch(this.getRollType()){case 1:-1==t&&a?this.tcView(!1):this.tcView(a);break;case 2:-1==t&&a?this.tcView(!0):this.tcView(this.scrollTop()>0&&a?!1:a);break;default:this.tcView(a)}this.placeView()},b.placeView=function(){var a,b,c;return 1>x||!u.hasOwnProperty("oTop")?!1:(a=0,b=this.scrollTop(),c=u.oTop+u.oHeight+b,c>=x?(a=s?u.oTop+b+(x-c):x-b-u.oHeight,f.attr(this._rd,1).css("top",this.px(a))):("1"==f.attr(this._rd)&&f.removeAttr("style"),f.attr(this._rd,0)),void 0)},b.scrollEvent=function(){var b=this,c=!1,d=null,e=0,f=0;a(window).scroll(function(){e=b.scrollTop(),c||(t=e>=f?-1:1),b.scrollExp(),f=e}),a(document).on("mousewheel DOMMouseScroll wheel",function(a){c=!0,d=a.originalEvent,t=d.wheelDelta&&(d.wheelDelta>0?1:-1)||d.detail&&(d.detail>0?-1:1),b.wheelExp(a)}).mousedown(function(){c=!1})},b.wheelExp=function(){return this.isClicked()?(this.setIsClick(!1),a(this.scroll).stop(!0,!0),void 0):!0},b.createStyle=function(){var b=[],c=[y.name,":",y.value,"px;"].join("");this.isIE6()?(b.push("html{_text-overflow:ellipsis;/*background-image:url(about:blank);background-attachment:fixed;*/}"),b.push("."+this._onClass+"{position:absolute;bottom:auto;left:"+y.left+"px !important;"+c+"}"),b.push("."+this._topExp+"{/*left:0px;*/"+y.name+":expression(eval(document.documentElement.scrollTop + "+y.value+"));")):b.push("."+this._onClass+"{position:fixed;left:"+y.left+"px !important;"+c+"}"),a("body").append('<style type="text/css" id="$1">$2</style>'.replace("$1",this._style.substring(1)).replace("$2",b.join(""))),this.isIE6()&&f.addClass(this._topExp),!1===this.onClass&&(h=this._onClass)},b.getOffsetExp=function(){var a=d.offset().left,b=a+d.outerWidth();return{left:Math.max(0,a)+n,right:Math.max(0,b-this.titContainerWidth())-n}},b.titContainerWidth=function(){return parseFloat(f.outerWidth(!0))||0},b.titContainerHeight=function(){return parseFloat(f.outerHeight(!0))||0},b.isStickRight=function(){return"right"===l},b.isClicked=function(){return r},b.setIsClick=function(a){r=a},b.posTypeToExp=function(){var a={name:"top",value:0,left:0},b=this.getOffsetExp();switch(k){case 2:a.value=Math.max(0,this.winDocWh().winH-this.titContainerHeight())/2,a.value+=m;break;case 3:this.isIE6()?a.value=Math.max(0,this.winDocWh().winH-this.titContainerHeight())-m:(a.name="bottom",a.value+=m);break;default:a.value+=m}return a.left=this.isStickRight()?b.right:b.left,a},b.thatInit=function(){var a=this.randStr();this._rd=this._rd.replace("$1",a),this._style=this._style.replace("$1",a),this._topExp=this._topExp.replace("$1",a),this._onClass=this._onClass.replace("$1",a)},b.init=function(){!this.titIsOff()&&this.hasLen(e)&&e.click(function(){b.setIsClick(!0),b.animate(e.index(this))}),this.createStyle(),this.scrollEvent(),this.scrollExp(),u=this.elInfo(f),u.oTop-=this.scrollTop()},b.thatInit(),d=a(this),e=a(b.tit,d),f=a(b.titContainer,d),g=a(b.block,d),h=b.onClass,i=b.offClass,j=b.titOnClass,k=b.positionType,l=b.stickType,m=parseFloat(b.offsetY),n=parseFloat(b.offsetX),o=parseFloat(b.early),p=0,q=-1,r=!1,s=b.isIE6(),t=0,u={},v=b.scrollTop(),w=b.valueTop(b.appoint),x=b.valueTop(b.place),y=b.posTypeToExp(),b.init()}}(jQuery);